<!DOCTYPE html>
<html>
  <head>
    <title>p5.play p5.SceneManager</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script src="./p5.play.js"></script>
    <script src="./p5.scenemanager.js"></script>
  </head>
  <body>
    <script>
      let mgr;

      let bubble;
      let bubble_ss;
      let bubble_stand;
      let bubble_move;
      function preload() {
        bubble_ss = loadSpriteSheet(
          "https://cdn.glitch.com/dc122c87-3702-4e86-8f63-eea043d864ca%2Fezgif-6-54b25e0a96a3.png?v=1628769250046",
          100,
          100,
          10
        );
      }

      function setup() {
        createCanvas(400, 400);
        mgr = new SceneManager();
        mgr.addScene(s1);
        mgr.addScene(s2);
        mgr.addScene(s3);
        mgr.showScene(s3);
        rectMode(CENTER);
      }

      function keyPressed() {
        switch (key) {
          case "1":
            mgr.showScene(s1);
            break;
          case "2":
            mgr.showScene(s2);
            break;
          case "3":
            mgr.showScene(s3);
            break;
        }
        mgr.handleEvent("keyPressed");
      }

      function draw() {
        mgr.draw();
      }

      function s1() {
        this.enter = function() {
          background(random(255));
          noStroke();
          fill(random(255));
          circle(width / 2, height / 2, 300);
          fill(random(255));
          circle(width / 2, height / 2, 200);
          fill(random(255));
          circle(width / 2, height / 2, 100);
        };
      }

      function s2() {
        this.enter = function() {
          background(random(255));
          noStroke();
          fill(random(255));
          square(width / 2, height / 2, 300);
          fill(random(255));
          square(width / 2, height / 2, 200);
          fill(random(255));
          square(width / 2, height / 2, 100);
        };
      }

      function s3() {
        this.setup = function() {
          bubble_stand = loadAnimation(bubble_ss);
          bubble_stand.stop();
          bubble_move = loadAnimation(bubble_ss);
          bubble = createSprite(100, 100, 45, 66);
          bubble.addAnimation("stand", bubble_stand);
          bubble.addAnimation("move", bubble_move);
        };
        this.draw = function() {
          background("lavender");
          if (keyDown("a") || keyDown("s") || keyDown("d") || keyDown("w")) {
            bubble.changeAnimation("move");
          }

          if (
            keyWentUp("a") ||
            keyWentUp("s") ||
            keyWentUp("d") ||
            keyWentUp("w")
          ) {
            bubble.changeAnimation("stand");
          }

          if (keyDown("d")) {
            bubble.position.x += 3;
          }
          if (keyDown("a")) {
            bubble.position.x -= 3;
          }
          if (keyDown("s")) {
            bubble.position.y += 3;
          }
          if (keyDown("w")) {
            bubble.position.y -= 3;
          }
          drawSprites();
        };
      }
    </script>
    <pre>
      https://ezgif.com/gif-to-sprite
    </pre>
  </body>
</html>
